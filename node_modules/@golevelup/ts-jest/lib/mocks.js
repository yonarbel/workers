"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createMock = void 0;
const globals_1 = require("@jest/globals");
const createRecursiveMockProxy = (name) => {
    const cache = new Map();
    const proxy = new Proxy({}, {
        get: (obj, prop) => {
            const propName = prop.toString();
            if (cache.has(prop)) {
                return cache.get(prop);
            }
            const checkProp = obj[prop];
            const mockedProp = prop in obj
                ? typeof checkProp === 'function'
                    ? globals_1.jest.fn()
                    : checkProp
                : propName === 'then'
                    ? undefined
                    : createRecursiveMockProxy(propName);
            cache.set(prop, mockedProp);
            return mockedProp;
        },
    });
    return globals_1.jest.fn(() => proxy);
};
const createMock = (partial = {}, options = {}) => {
    const cache = new Map();
    const { name = 'mock' } = options;
    const proxy = new Proxy(partial, {
        get: (obj, prop) => {
            if (prop === 'inspect' ||
                prop === 'then' ||
                (typeof prop === 'symbol' &&
                    prop.toString() === 'Symbol(util.inspect.custom)')) {
                return undefined;
            }
            if (cache.has(prop)) {
                return cache.get(prop);
            }
            const checkProp = obj[prop];
            let mockedProp;
            if (prop in obj) {
                mockedProp =
                    typeof checkProp === 'function' ? globals_1.jest.fn(checkProp) : checkProp;
            }
            else if (prop === 'constructor') {
                mockedProp = () => undefined;
            }
            else {
                mockedProp = createRecursiveMockProxy(`${name}.${prop.toString()}`);
            }
            cache.set(prop, mockedProp);
            return mockedProp;
        },
    });
    return proxy;
};
exports.createMock = createMock;
//# sourceMappingURL=mocks.js.map